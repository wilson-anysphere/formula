<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formula</title>
  <style>
    /*
     * FORMULA DESIGN SYSTEM
     * Excel functionality + Cursor polish
     * Light mode, professional, clean
     */
    
    :root {
      /* Light mode - subtle depth, professional */
      --bg-app: #f5f5f5;
      --bg-surface: #fafafa;
      --bg-elevated: #ffffff;
      --bg-hover: #eeeeee;
      --bg-active: #e4e4e4;
      --bg-inset: #f0f0f0;
      
      /* Text */
      --text-primary: #1a1a1a;
      --text-secondary: #5c5c5c;
      --text-tertiary: #8a8a8a;
      
      /* Borders - subtle */
      --border: #e0e0e0;
      --border-strong: #c8c8c8;
      
      /* Accent - professional blue */
      --accent: #0969da;
      --accent-bg: #ddf4ff;
      --accent-border: #54aeff;
      
      /* Selection */
      --selection-bg: rgba(9, 105, 218, 0.08);
      --selection-border: #0969da;
      
      /* Semantic */
      --green: #1a7f37;
      --green-bg: #dafbe1;
      --red: #cf222e;
      --red-bg: #ffebe9;
      
      /* Grid */
      --grid-line: #e6e6e6;
      --grid-header-bg: #f5f5f5;
      
      /* Sizing */
      --radius: 4px;
      --radius-sm: 3px;
      
      /* Typography */
      --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
      --font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: var(--font-sans);
      font-size: 13px;
      background: var(--bg-app);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
    }

    .app {
      height: 100vh;
      display: grid;
      grid-template-columns: 1fr 340px;
      overflow: hidden;
    }

    .app-main {
      display: grid;
      grid-template-rows: auto auto auto 1fr auto auto;
      overflow: hidden;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       TITLE BAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .titlebar {
      display: flex;
      align-items: center;
      height: 32px;
      padding: 0 10px;
      background: var(--bg-app);
      border-bottom: 1px solid var(--border);
      gap: 10px;
    }

    .window-controls {
      display: flex;
      gap: 6px;
    }

    .window-btn {
      width: 11px;
      height: 11px;
      border-radius: 50%;
      border: none;
    }

    .window-btn.close { background: #ff5f57; }
    .window-btn.minimize { background: #febc2e; }
    .window-btn.maximize { background: #28c840; }

    .app-title {
      font-weight: 600;
      font-size: 12px;
      color: var(--text-primary);
    }

    .doc-name {
      color: var(--text-secondary);
      font-weight: 400;
      font-size: 12px;
    }

    .titlebar-spacer {
      flex: 1;
    }

    .titlebar-actions {
      display: flex;
      gap: 6px;
    }

    .titlebar-btn {
      height: 22px;
      padding: 0 10px;
      display: flex;
      align-items: center;
      gap: 4px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-surface);
      color: var(--text-secondary);
      font-size: 11px;
      cursor: pointer;
    }

    .titlebar-btn:hover {
      background: var(--bg-hover);
    }

    .titlebar-btn.primary {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    .titlebar-btn.primary:hover {
      filter: brightness(1.1);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RIBBON - Excel-style tabs and commands
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .ribbon {
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border);
    }

    .ribbon-tabs {
      display: flex;
      height: 26px;
      padding: 0 6px;
      gap: 0;
      border-bottom: 1px solid var(--border);
      background: var(--bg-surface);
    }

    .ribbon-tab {
      padding: 0 12px;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      margin-bottom: -1px;
      transition: all 80ms;
    }

    .ribbon-tab:hover {
      color: var(--text-primary);
    }

    .ribbon-tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .ribbon-tab.file {
      background: var(--accent);
      color: white;
      border-radius: 2px;
      margin-right: 4px;
      border-bottom: none;
    }

    .ribbon-tab.file:hover {
      filter: brightness(1.1);
    }

    .ribbon-content {
      display: flex;
      padding: 4px 8px;
      gap: 10px;
      min-height: 70px;
      background: var(--bg-surface);
    }

    .ribbon-group {
      display: flex;
      flex-direction: column;
      gap: 2px;
      padding-right: 10px;
      border-right: 1px solid var(--border);
    }

    .ribbon-group:last-child {
      border-right: none;
    }

    .ribbon-group-content {
      display: flex;
      gap: 4px;
      flex: 1;
      align-items: flex-start;
    }

    .ribbon-group-label {
      font-size: 10px;
      color: var(--text-tertiary);
      text-align: center;
    }

    .ribbon-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 2px;
      padding: 3px 6px;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-primary);
      font-size: 10px;
      cursor: pointer;
      white-space: nowrap;
    }

    .ribbon-btn:hover {
      background: var(--bg-hover);
    }

    .ribbon-btn-lg {
      flex-direction: column;
      padding: 4px 6px;
      min-width: 48px;
    }

    .ribbon-btn-lg .ribbon-btn-icon {
      font-size: 18px;
    }

    .ribbon-btn-lg span:last-child {
      font-size: 9px;
    }

    .ribbon-btn-sm {
      font-size: 10px;
      justify-content: flex-start;
    }

    .ribbon-btn-icon {
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-primary);
      font-size: 12px;
      cursor: pointer;
    }

    .ribbon-btn-icon:hover {
      background: var(--bg-hover);
    }

    .ribbon-stack {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .ribbon-row {
      display: flex;
      gap: 1px;
      align-items: center;
    }

    .ribbon-sep {
      width: 1px;
      height: 16px;
      background: var(--border);
      margin: 0 3px;
    }

    .ribbon-select {
      height: 22px;
      padding: 0 6px;
      border: 1px solid var(--border);
      border-radius: 2px;
      background: var(--bg-elevated);
      font-size: 11px;
      color: var(--text-primary);
      cursor: pointer;
    }

    .ribbon-select:hover {
      border-color: var(--border-strong);
    }

    .font-select {
      width: 100px;
    }

    .size-select {
      width: 44px;
    }

    .number-select {
      width: 90px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FORMULA BAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .formula-bar {
      display: flex;
      align-items: center;
      height: 26px;
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border);
    }

    .name-box-container {
      display: flex;
      align-items: center;
      width: 100px;
      height: 100%;
      border-right: 1px solid var(--border);
    }

    .name-box {
      flex: 1;
      height: 100%;
      padding: 0 6px;
      border: none;
      background: transparent;
      font-size: 11px;
      color: var(--text-primary);
      text-align: center;
    }

    .name-box:focus {
      outline: none;
      background: var(--bg-elevated);
    }

    .name-box-dropdown {
      width: 16px;
      height: 100%;
      border: none;
      background: transparent;
      color: var(--text-tertiary);
      font-size: 8px;
      cursor: pointer;
    }

    .name-box-dropdown:hover {
      background: var(--bg-hover);
    }

    .formula-buttons {
      display: flex;
      align-items: center;
      height: 100%;
      border-right: 1px solid var(--border);
    }

    .formula-btn {
      width: 24px;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      background: transparent;
      color: var(--text-tertiary);
      font-size: 12px;
      cursor: pointer;
    }

    .formula-btn:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    .formula-btn.cancel:hover {
      color: var(--red);
    }

    .formula-btn.confirm:hover {
      color: var(--green);
    }

    .formula-btn.fx {
      font-style: italic;
      font-weight: 600;
      font-size: 11px;
    }

    .formula-input {
      flex: 1;
      height: 100%;
      padding: 0 8px;
      border: none;
      background: transparent;
      font-family: var(--font-mono);
      font-size: 12px;
      color: var(--text-primary);
    }

    .formula-input:focus {
      outline: none;
      background: var(--bg-elevated);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAIN AREA
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .main {
      display: flex;
      overflow: hidden;
      flex: 1;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       GRID
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .grid-container {
      flex: 1;
      overflow: hidden;
      background: var(--bg-surface);
    }

    .grid-scroll {
      height: 100%;
      overflow: auto;
    }

    .grid {
      display: grid;
      grid-template-columns: 36px repeat(10, minmax(80px, 1fr));
      font-size: 11px;
    }

    .grid-corner {
      position: sticky;
      top: 0;
      left: 0;
      z-index: 30;
      background: var(--grid-header-bg);
      border-right: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
    }

    .col-header {
      position: sticky;
      top: 0;
      z-index: 20;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-app);
      border-right: 1px solid var(--grid-line);
      border-bottom: 1px solid var(--border);
      font-weight: 500;
      color: var(--text-tertiary);
      font-size: 10px;
      user-select: none;
    }

    .col-header:hover {
      background: var(--bg-hover);
    }

    .col-header.selected {
      background: var(--accent-bg);
      color: var(--accent);
    }

    .row-header {
      position: sticky;
      left: 0;
      z-index: 10;
      width: 36px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg-app);
      border-right: 1px solid var(--border);
      border-bottom: 1px solid var(--grid-line);
      font-weight: 500;
      color: var(--text-tertiary);
      font-size: 10px;
      user-select: none;
    }

    .row-header:hover {
      background: var(--bg-hover);
    }

    .row-header.selected {
      background: var(--accent-bg);
      color: var(--accent);
    }

    .cell {
      height: 20px;
      padding: 0 5px;
      display: flex;
      align-items: center;
      background: var(--bg-elevated);
      border-right: 1px solid var(--grid-line);
      border-bottom: 1px solid var(--grid-line);
      font-family: var(--font-mono);
      font-size: 11px;
      overflow: hidden;
      white-space: nowrap;
    }

    .cell.number {
      justify-content: flex-end;
      font-variant-numeric: tabular-nums;
    }

    .cell.header {
      font-family: var(--font-sans);
      font-weight: 500;
      color: var(--text-primary);
      background: var(--bg-surface);
    }

    .cell.selected {
      background: var(--selection-bg);
    }

    .cell.active {
      box-shadow: inset 0 0 0 2px var(--selection-border);
      background: var(--bg-surface);
      z-index: 5;
      position: relative;
    }

    .cell.positive { color: var(--green); }
    .cell.negative { color: var(--red); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       AI SIDEBAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .ai-sidebar {
      display: flex;
      flex-direction: column;
      background: var(--bg-surface);
      border-left: 1px solid var(--border);
      height: 100vh;
    }

    .ai-context {
      padding: 6px 10px;
      background: var(--bg-inset);
      border-bottom: 1px solid var(--border);
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .ai-tag {
      padding: 2px 6px;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 3px;
      font-size: 10px;
      color: var(--text-secondary);
    }

    .ai-tag.active {
      background: var(--accent-bg);
      border-color: var(--accent-border);
      color: var(--accent);
    }

    .ai-messages {
      flex: 1;
      overflow-y: auto;
      padding: 8px 10px;
    }

    .ai-msg {
      margin-bottom: 12px;
    }

    .ai-msg-header {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .ai-avatar {
      width: 18px;
      height: 18px;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 9px;
      font-weight: 600;
    }

    .ai-avatar.user {
      background: var(--bg-inset);
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .ai-avatar.assistant {
      background: var(--accent);
      color: white;
    }

    .ai-sender {
      font-weight: 500;
      font-size: 11px;
    }

    .ai-time {
      font-size: 10px;
      color: var(--text-tertiary);
    }

    .ai-msg-body {
      padding-left: 24px;
      font-size: 12px;
      line-height: 1.45;
      color: var(--text-primary);
    }

    .ai-msg-body p {
      margin: 0 0 6px;
    }

    /* Diff preview */
    .ai-diff {
      margin-top: 8px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      overflow: hidden;
      background: var(--bg-elevated);
    }

    .ai-diff-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 8px;
      background: var(--bg-inset);
      border-bottom: 1px solid var(--border);
      font-size: 10px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    .ai-diff-stats {
      display: flex;
      gap: 8px;
      font-size: 10px;
      font-weight: 400;
    }

    .ai-diff-stats .add { color: var(--green); }
    .ai-diff-stats .mod { color: #9a6700; }

    .ai-diff-body {
      padding: 4px 6px;
      font-family: var(--font-mono);
      font-size: 10px;
      max-height: 140px;
      overflow-y: auto;
    }

    .ai-diff-line {
      display: flex;
      padding: 2px 6px;
      border-radius: 2px;
      margin-bottom: 1px;
    }

    .ai-diff-line.add {
      background: var(--green-bg);
      color: var(--green);
    }

    .ai-diff-line .cell-ref {
      width: 52px;
      font-weight: 500;
    }

    .ai-diff-actions {
      display: flex;
      gap: 6px;
      padding: 6px 8px;
      border-top: 1px solid var(--border);
      background: var(--bg-inset);
    }

    .ai-btn {
      flex: 1;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-sm);
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
    }

    .ai-btn.primary {
      background: var(--accent);
      border: none;
      color: white;
    }

    .ai-btn.primary:hover {
      filter: brightness(1.1);
    }

    .ai-btn.secondary {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      color: var(--text-secondary);
    }

    .ai-btn.secondary:hover {
      background: var(--bg-hover);
    }

    .ai-input-area {
      padding: 8px;
      border-top: 1px solid var(--border);
      background: var(--bg-app);
    }

    .ai-input-box {
      display: flex;
      align-items: flex-end;
      gap: 6px;
      padding: 6px 8px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--bg-elevated);
    }

    .ai-input-box:focus-within {
      border-color: var(--accent);
    }

    .ai-input {
      flex: 1;
      border: none;
      font-family: var(--font-sans);
      font-size: 12px;
      color: var(--text-primary);
      outline: none;
      resize: none;
      min-height: 18px;
      max-height: 60px;
      background: transparent;
    }

    .ai-input::placeholder {
      color: var(--text-tertiary);
    }

    .ai-send {
      width: 22px;
      height: 22px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--accent);
      border: none;
      border-radius: 3px;
      color: white;
      cursor: pointer;
      font-size: 11px;
    }

    .ai-send:hover {
      filter: brightness(1.1);
    }

    .ai-hints {
      display: flex;
      gap: 10px;
      margin-top: 6px;
      font-size: 10px;
      color: var(--text-tertiary);
    }

    .ai-hints kbd {
      padding: 1px 3px;
      background: var(--bg-surface);
      border-radius: 2px;
      font-family: var(--font-mono);
      font-size: 9px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SHEET TABS
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .sheet-bar {
      display: flex;
      align-items: center;
      height: 24px;
      padding: 0 6px;
      background: var(--bg-app);
      border-top: 1px solid var(--border);
      gap: 2px;
    }

    .sheet-nav {
      display: flex;
      gap: 1px;
    }

    .sheet-nav-btn {
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-tertiary);
      cursor: pointer;
      font-size: 9px;
    }

    .sheet-nav-btn:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    .sheet-tabs {
      display: flex;
      gap: 1px;
      flex: 1;
    }

    .sheet-tab {
      padding: 3px 12px;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-bottom: none;
      border-radius: 3px 3px 0 0;
      font-size: 10px;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .sheet-tab:hover {
      background: var(--bg-hover);
    }

    .sheet-tab.active {
      background: var(--bg-elevated);
      color: var(--text-primary);
      font-weight: 500;
      border-bottom: 1px solid var(--bg-elevated);
      margin-bottom: -1px;
    }

    .sheet-add {
      width: 18px;
      height: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-tertiary);
      cursor: pointer;
      font-size: 12px;
    }

    .sheet-add:hover {
      background: var(--bg-hover);
      color: var(--text-primary);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       STATUS BAR
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    
    .statusbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 20px;
      padding: 0 8px;
      background: var(--bg-app);
      border-top: 1px solid var(--border);
      font-size: 10px;
      color: var(--text-tertiary);
    }

    .status-left, .status-right {
      display: flex;
      gap: 12px;
    }

    .status-item strong {
      font-weight: 500;
      color: var(--text-secondary);
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-app);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-strong);
      border-radius: 5px;
      border: 2px solid var(--bg-app);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-tertiary);
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Left side: Excel chrome -->
    <div class="app-main">
      <!-- Title Bar -->
      <div class="titlebar">
      <div class="window-controls">
        <button class="window-btn close"></button>
        <button class="window-btn minimize"></button>
        <button class="window-btn maximize"></button>
      </div>
      <span class="app-title">Formula</span>
      <span class="doc-name">â€” Q4 Revenue Model.xlsx</span>
      <div class="titlebar-spacer"></div>
      <div class="titlebar-actions">
        <button class="titlebar-btn">Share</button>
        <button class="titlebar-btn primary">Save</button>
      </div>
    </div>

    <!-- Ribbon -->
    <div class="ribbon">
      <div class="ribbon-tabs">
        <button class="ribbon-tab file">File</button>
        <button class="ribbon-tab active">Home</button>
        <button class="ribbon-tab">Insert</button>
        <button class="ribbon-tab">Page Layout</button>
        <button class="ribbon-tab">Formulas</button>
        <button class="ribbon-tab">Data</button>
        <button class="ribbon-tab">Review</button>
        <button class="ribbon-tab">View</button>
        <button class="ribbon-tab">Help</button>
      </div>
      <div class="ribbon-content">
        <!-- Clipboard -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <button class="ribbon-btn ribbon-btn-lg">
              <span class="ribbon-btn-icon">ğŸ“‹</span>
              <span>Paste</span>
            </button>
            <div class="ribbon-stack">
              <button class="ribbon-btn ribbon-btn-sm">âœ‚ï¸ Cut</button>
              <button class="ribbon-btn ribbon-btn-sm">ğŸ“„ Copy</button>
              <button class="ribbon-btn ribbon-btn-sm">ğŸ–Œï¸ Format Painter</button>
            </div>
          </div>
          <div class="ribbon-group-label">Clipboard</div>
        </div>

        <!-- Font -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <div class="ribbon-stack">
              <div class="ribbon-row">
                <select class="ribbon-select font-select"><option>Calibri</option></select>
                <select class="ribbon-select size-select"><option>11</option></select>
              </div>
              <div class="ribbon-row">
                <button class="ribbon-btn-icon" title="Bold"><b>B</b></button>
                <button class="ribbon-btn-icon" title="Italic"><i>I</i></button>
                <button class="ribbon-btn-icon" title="Underline"><u>U</u></button>
                <span class="ribbon-sep"></span>
                <button class="ribbon-btn-icon" title="Borders">âŠ</button>
                <button class="ribbon-btn-icon" title="Fill Color">ğŸ¨</button>
                <button class="ribbon-btn-icon" title="Font Color">AÌ²</button>
              </div>
            </div>
          </div>
          <div class="ribbon-group-label">Font</div>
        </div>

        <!-- Alignment -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <div class="ribbon-stack">
              <div class="ribbon-row">
                <button class="ribbon-btn-icon" title="Align Top">â¬†</button>
                <button class="ribbon-btn-icon" title="Align Middle">â‡…</button>
                <button class="ribbon-btn-icon" title="Align Bottom">â¬‡</button>
                <span class="ribbon-sep"></span>
                <button class="ribbon-btn-icon" title="Orientation">â†»</button>
              </div>
              <div class="ribbon-row">
                <button class="ribbon-btn-icon" title="Align Left">â¬…</button>
                <button class="ribbon-btn-icon" title="Center">â¬Œ</button>
                <button class="ribbon-btn-icon" title="Align Right">â¡</button>
                <span class="ribbon-sep"></span>
                <button class="ribbon-btn-icon" title="Indent">â‡¥</button>
                <button class="ribbon-btn-icon" title="Outdent">â‡¤</button>
              </div>
            </div>
            <div class="ribbon-stack">
              <button class="ribbon-btn ribbon-btn-sm">â†© Wrap Text</button>
              <button class="ribbon-btn ribbon-btn-sm">âŠ Merge & Center â–¾</button>
            </div>
          </div>
          <div class="ribbon-group-label">Alignment</div>
        </div>

        <!-- Number -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <div class="ribbon-stack">
              <select class="ribbon-select number-select"><option>General</option></select>
              <div class="ribbon-row">
                <button class="ribbon-btn-icon" title="Currency">$</button>
                <button class="ribbon-btn-icon" title="Percent">%</button>
                <button class="ribbon-btn-icon" title="Comma">,</button>
                <span class="ribbon-sep"></span>
                <button class="ribbon-btn-icon" title="Increase Decimal">.0â†’</button>
                <button class="ribbon-btn-icon" title="Decrease Decimal">â†.0</button>
              </div>
            </div>
          </div>
          <div class="ribbon-group-label">Number</div>
        </div>

        <!-- Styles -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <button class="ribbon-btn ribbon-btn-lg">
              <span class="ribbon-btn-icon">ğŸ“Š</span>
              <span>Conditional Formatting â–¾</span>
            </button>
            <button class="ribbon-btn ribbon-btn-lg">
              <span class="ribbon-btn-icon">ğŸ“‹</span>
              <span>Format as Table â–¾</span>
            </button>
            <button class="ribbon-btn ribbon-btn-lg">
              <span class="ribbon-btn-icon">ğŸ¨</span>
              <span>Cell Styles â–¾</span>
            </button>
          </div>
          <div class="ribbon-group-label">Styles</div>
        </div>

        <!-- Cells -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <div class="ribbon-stack">
              <button class="ribbon-btn ribbon-btn-sm">âŠ• Insert â–¾</button>
              <button class="ribbon-btn ribbon-btn-sm">âŠ– Delete â–¾</button>
              <button class="ribbon-btn ribbon-btn-sm">âŠ¡ Format â–¾</button>
            </div>
          </div>
          <div class="ribbon-group-label">Cells</div>
        </div>

        <!-- Editing -->
        <div class="ribbon-group">
          <div class="ribbon-group-content">
            <div class="ribbon-stack">
              <button class="ribbon-btn ribbon-btn-sm">Î£ AutoSum â–¾</button>
              <button class="ribbon-btn ribbon-btn-sm">â†“ Fill â–¾</button>
              <button class="ribbon-btn ribbon-btn-sm">âŒ« Clear â–¾</button>
            </div>
            <div class="ribbon-stack">
              <button class="ribbon-btn ribbon-btn-sm">â‡… Sort & Filter â–¾</button>
              <button class="ribbon-btn ribbon-btn-sm">âŒ• Find & Select â–¾</button>
            </div>
          </div>
          <div class="ribbon-group-label">Editing</div>
        </div>
      </div>
    </div>

    <!-- Formula Bar -->
    <div class="formula-bar">
      <div class="name-box-container">
        <input type="text" class="name-box" value="D7">
        <button class="name-box-dropdown">â–¾</button>
      </div>
      <div class="formula-buttons">
        <button class="formula-btn cancel" title="Cancel">âœ•</button>
        <button class="formula-btn confirm" title="Enter">âœ“</button>
        <button class="formula-btn fx" title="Insert Function">fx</button>
      </div>
      <input type="text" class="formula-input" value="=SUM(D3:D6)">
    </div>

    <!-- Main Area -->
    <div class="main">
      <!-- Grid -->
      <div class="grid-container">
        <div class="grid-scroll">
          <div class="grid">
            <!-- Headers -->
            <div class="grid-corner"></div>
            <div class="col-header">A</div>
            <div class="col-header">B</div>
            <div class="col-header">C</div>
            <div class="col-header selected">D</div>
            <div class="col-header">E</div>
            <div class="col-header">F</div>
            <div class="col-header">G</div>
            <div class="col-header">H</div>
            <div class="col-header">I</div>
            <div class="col-header">J</div>

            <!-- Row 1 -->
            <div class="row-header">1</div>
            <div class="cell header" style="grid-column: span 4">Q4 Revenue Forecast</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 2 - Headers -->
            <div class="row-header">2</div>
            <div class="cell header">Segment</div>
            <div class="cell header number">Units</div>
            <div class="cell header number">Price</div>
            <div class="cell header number">Revenue</div>
            <div class="cell header number">YoY</div>
            <div class="cell header number">Q3 Actual</div>
            <div class="cell header number">Variance</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 3 -->
            <div class="row-header">3</div>
            <div class="cell">Enterprise</div>
            <div class="cell number">1,250</div>
            <div class="cell number">$2,400</div>
            <div class="cell number">$3,000,000</div>
            <div class="cell number positive">+12.4%</div>
            <div class="cell number">$2,668,000</div>
            <div class="cell number positive">$332,000</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 4 -->
            <div class="row-header">4</div>
            <div class="cell">Professional</div>
            <div class="cell number">8,400</div>
            <div class="cell number">$480</div>
            <div class="cell number">$4,032,000</div>
            <div class="cell number positive">+8.2%</div>
            <div class="cell number">$3,727,000</div>
            <div class="cell number positive">$305,000</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 5 -->
            <div class="row-header">5</div>
            <div class="cell">Starter</div>
            <div class="cell number">24,800</div>
            <div class="cell number">$96</div>
            <div class="cell number">$2,380,800</div>
            <div class="cell number negative">âˆ’2.1%</div>
            <div class="cell number">$2,431,700</div>
            <div class="cell number negative">($50,900)</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 6 -->
            <div class="row-header">6</div>
            <div class="cell">Services</div>
            <div class="cell number">â€”</div>
            <div class="cell number">â€”</div>
            <div class="cell number">$1,845,000</div>
            <div class="cell number positive">+18.5%</div>
            <div class="cell number">$1,557,000</div>
            <div class="cell number positive">$288,000</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Row 7 - Total -->
            <div class="row-header selected">7</div>
            <div class="cell header selected">Total</div>
            <div class="cell header number selected">34,450</div>
            <div class="cell header selected"></div>
            <div class="cell header number active">$11,257,800</div>
            <div class="cell header number positive">+9.1%</div>
            <div class="cell header number">$10,383,700</div>
            <div class="cell header number positive">$874,100</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <!-- Empty rows -->
            <div class="row-header">8</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">9</div>
            <div class="cell header" style="grid-column: span 2">Expenses</div>
            <div class="cell header"></div>
            <div class="cell header number">Amount</div>
            <div class="cell header number">% Rev</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">10</div>
            <div class="cell">Cost of Revenue</div>
            <div class="cell"></div><div class="cell"></div>
            <div class="cell number">$3,377,340</div>
            <div class="cell number">30%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">11</div>
            <div class="cell">Sales & Marketing</div>
            <div class="cell"></div><div class="cell"></div>
            <div class="cell number">$2,251,560</div>
            <div class="cell number">20%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">12</div>
            <div class="cell">R&D</div>
            <div class="cell"></div><div class="cell"></div>
            <div class="cell number">$1,688,670</div>
            <div class="cell number">15%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">13</div>
            <div class="cell">G&A</div>
            <div class="cell"></div><div class="cell"></div>
            <div class="cell number">$1,125,780</div>
            <div class="cell number">10%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">14</div>
            <div class="cell header">Total Expenses</div>
            <div class="cell header"></div><div class="cell header"></div>
            <div class="cell header number">$8,443,350</div>
            <div class="cell header number">75%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">15</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">16</div>
            <div class="cell header">Net Income</div>
            <div class="cell header"></div><div class="cell header"></div>
            <div class="cell header number positive">$2,814,450</div>
            <div class="cell header number positive">25%</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">17</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">18</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">19</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>

            <div class="row-header">20</div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Sheet Tabs -->
    <div class="sheet-bar">
      <div class="sheet-nav">
        <button class="sheet-nav-btn">â—€</button>
        <button class="sheet-nav-btn">â–¶</button>
      </div>
      <div class="sheet-tabs">
        <div class="sheet-tab active">Q4 Forecast</div>
        <div class="sheet-tab">Historical</div>
        <div class="sheet-tab">Assumptions</div>
      </div>
      <button class="sheet-add">+</button>
    </div>

    <!-- Status Bar -->
    <div class="statusbar">
      <div class="status-left">
        <span>Ready</span>
      </div>
      <div class="status-right">
        <span>Sum: <strong>$11,257,800</strong></span>
        <span>Average: <strong>$2,814,450</strong></span>
        <span>Count: <strong>4</strong></span>
        <span>100%</span>
      </div>
    </div>
    </div><!-- end app-main -->

    <!-- AI Sidebar - full height -->
    <div class="ai-sidebar">
      <div class="ai-context">
        <span class="ai-tag active">Q4 Revenue Model</span>
        <span class="ai-tag">D7</span>
        <span class="ai-tag">12 formulas</span>
      </div>

      <div class="ai-messages">
        <div class="ai-msg">
          <div class="ai-msg-header">
            <div class="ai-avatar user">Y</div>
            <span class="ai-sender">You</span>
            <span class="ai-time">2m ago</span>
          </div>
          <div class="ai-msg-body">
            <p>Add a sensitivity table showing net income at 5%, 10%, 15% revenue growth</p>
          </div>
        </div>

        <div class="ai-msg">
          <div class="ai-msg-header">
            <div class="ai-avatar assistant">F</div>
            <span class="ai-sender">Formula</span>
            <span class="ai-time">2m ago</span>
          </div>
          <div class="ai-msg-body">
            <p>I'll create a sensitivity analysis table in H9:K13.</p>
            
            <div class="ai-diff">
              <div class="ai-diff-header">
                <span>Proposed Changes</span>
                <div class="ai-diff-stats">
                  <span class="add">+18 cells</span>
                </div>
              </div>
              <div class="ai-diff-body">
                <div class="ai-diff-line add">
                  <span class="cell-ref">H9</span>
                  <span>"Sensitivity"</span>
                </div>
                <div class="ai-diff-line add">
                  <span class="cell-ref">I9:K9</span>
                  <span>+5%, +10%, +15%</span>
                </div>
                <div class="ai-diff-line add">
                  <span class="cell-ref">H10</span>
                  <span>"Revenue"</span>
                </div>
                <div class="ai-diff-line add">
                  <span class="cell-ref">I10</span>
                  <span>=D7*1.05</span>
                </div>
                <div class="ai-diff-line add">
                  <span class="cell-ref">H11</span>
                  <span>"Net Income"</span>
                </div>
                <div class="ai-diff-line add">
                  <span class="cell-ref">I11</span>
                  <span>=I10*0.25</span>
                </div>
              </div>
              <div class="ai-diff-actions">
                <button class="ai-btn secondary">Reject</button>
                <button class="ai-btn primary">Apply Changes</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="ai-input-area">
        <div class="ai-input-box">
          <textarea class="ai-input" placeholder="Ask anything about your spreadsheet..." rows="1"></textarea>
          <button class="ai-send">â†’</button>
        </div>
        <div class="ai-hints">
          <span><kbd>âŒ˜K</kbd> inline edit</span>
          <span><kbd>@</kbd> mention range</span>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
