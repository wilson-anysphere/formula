{
  "schemaVersion": 1,
  "caseSet": "financial-odd-coupon-invalid-schedule",
  "defaultSheet": "Sheet1",
  "cases": [
    {
      "formula": "=ODDFPRICE(DATE(2020,1,20),DATE(2021,8,30),DATE(2020,1,15),DATE(2020,2,28),0.08,0.075,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFPRICE"
      ],
      "description": "ODDFPRICE invalid schedule: first_coupon is not reachable from maturity by stepping 6 months (day-of-month mismatch; maturity-anchored EDATE schedule hits 2020-02-29, not 2020-02-28)",
      "id": "oddfprice_invalid_schedule_dom_mismatch_ce323f02a9ef"
    },
    {
      "formula": "=ODDFYIELD(DATE(2020,1,20),DATE(2021,8,30),DATE(2020,1,15),DATE(2020,2,28),0.08,98,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFYIELD"
      ],
      "description": "ODDFYIELD invalid schedule: first_coupon is not reachable from maturity by stepping 6 months (day-of-month mismatch; expected #NUM!)",
      "id": "oddfyield_invalid_schedule_dom_mismatch_352719794f9c"
    },
    {
      "formula": "=ODDFPRICE(DATE(2022,12,20),DATE(2024,7,31),DATE(2022,12,15),DATE(2023,1,30),0.05,0.06,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFPRICE"
      ],
      "description": "ODDFPRICE invalid schedule: maturity is EOM (month-end schedule) but first_coupon is not; maturity-anchored EOMONTH stepping never hits first_coupon",
      "id": "oddfprice_invalid_schedule_maturity_eom_first_not_ce705dfabb4e"
    },
    {
      "formula": "=ODDFYIELD(DATE(2022,12,20),DATE(2024,7,31),DATE(2022,12,15),DATE(2023,1,30),0.05,98,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFYIELD"
      ],
      "description": "ODDFYIELD invalid schedule: maturity is EOM but first_coupon is not (EOM schedule stepping)",
      "id": "oddfyield_invalid_schedule_maturity_eom_first_not_36ba94ae29a0"
    },
    {
      "formula": "=ODDFPRICE(DATE(2022,12,20),DATE(2024,7,30),DATE(2022,12,15),DATE(2023,1,31),0.05,0.06,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFPRICE"
      ],
      "description": "ODDFPRICE invalid schedule: maturity is not EOM (EDATE schedule) but first_coupon is EOM; maturity-anchored EDATE stepping never hits first_coupon",
      "id": "oddfprice_invalid_schedule_maturity_not_eom_first_is_8c4407616753"
    },
    {
      "formula": "=ODDFYIELD(DATE(2022,12,20),DATE(2024,7,30),DATE(2022,12,15),DATE(2023,1,31),0.05,98,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFYIELD"
      ],
      "description": "ODDFYIELD invalid schedule: maturity is not EOM but first_coupon is EOM (schedule stepping)",
      "id": "oddfyield_invalid_schedule_maturity_not_eom_first_is_7229368f6f7f"
    },
    {
      "formula": "=ODDLPRICE(DATE(2024,8,1),DATE(2025,1,31),DATE(2024,7,30),0.05,0.04,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLPRICE"
      ],
      "description": "ODDLPRICE invalid schedule: last_interest is not on the maturity-anchored coupon schedule implied by maturity+frequency (maturity is EOM but last_interest is not)",
      "id": "oddlprice_invalid_schedule_misaligned_last_interest_7844a6299f87"
    },
    {
      "formula": "=ODDLYIELD(DATE(2024,8,1),DATE(2025,1,31),DATE(2024,7,30),0.05,99,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLYIELD"
      ],
      "description": "ODDLYIELD invalid schedule: last_interest is not on the maturity-anchored coupon schedule implied by maturity+frequency (maturity is EOM but last_interest is not)",
      "id": "oddlyield_invalid_schedule_misaligned_last_interest_eae16064c1e4"
    },
    {
      "formula": "=ODDLPRICE(DATE(2024,8,15),DATE(2025,1,31),DATE(2024,7,30),0.05,0.04,100,2,1)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLPRICE",
        "basis1"
      ],
      "description": "ODDLPRICE invalid schedule: maturity is EOM but last_interest is not (basis=1; EOM schedule mismatch)",
      "id": "oddlprice_invalid_schedule_maturity_eom_last_not_basis1_33e1dc8781bb"
    },
    {
      "formula": "=ODDLYIELD(DATE(2024,8,15),DATE(2025,1,31),DATE(2024,7,30),0.05,99,100,2,1)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLYIELD",
        "basis1"
      ],
      "description": "ODDLYIELD invalid schedule: maturity is EOM but last_interest is not (basis=1; EOM schedule mismatch)",
      "id": "oddlyield_invalid_schedule_maturity_eom_last_not_basis1_a404bf685a42"
    },
    {
      "formula": "=ODDLPRICE(DATE(2024,8,15),DATE(2025,1,30),DATE(2024,7,31),0.05,0.04,100,2,1)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLPRICE",
        "basis1"
      ],
      "description": "ODDLPRICE invalid schedule: maturity is not EOM but last_interest is EOM (basis=1; EOM schedule mismatch)",
      "id": "oddlprice_invalid_schedule_maturity_not_eom_last_is_basis1_1c611371498e"
    },
    {
      "formula": "=ODDLYIELD(DATE(2024,8,15),DATE(2025,1,30),DATE(2024,7,31),0.05,99,100,2,1)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLYIELD",
        "basis1"
      ],
      "description": "ODDLYIELD invalid schedule: maturity is not EOM but last_interest is EOM (basis=1; EOM schedule mismatch)",
      "id": "oddlyield_invalid_schedule_maturity_not_eom_last_is_basis1_f57ee459ad99"
    },
    {
      "formula": "=ODDLPRICE(DATE(2024,7,1),DATE(2025,1,1),DATE(2025,1,2),0.05,0.04,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLPRICE"
      ],
      "description": "ODDLPRICE invalid schedule: last_interest is after maturity (schedule alignment / chronology)",
      "id": "oddlprice_invalid_schedule_last_after_maturity_69b5d9af2de5"
    },
    {
      "formula": "=ODDLYIELD(DATE(2024,7,1),DATE(2025,1,1),DATE(2025,1,2),0.05,99,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDLYIELD"
      ],
      "description": "ODDLYIELD invalid schedule: last_interest is after maturity (schedule alignment / chronology)",
      "id": "oddlyield_invalid_schedule_last_after_maturity_53d29e46e92c"
    },
    {
      "formula": "=ODDFPRICE(DATE(2020,8,1),DATE(2025,1,1),DATE(2020,1,1),DATE(2020,7,1),0.05,0.04,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFPRICE"
      ],
      "description": "ODDFPRICE invalid schedule: settlement is after first_coupon (expected #NUM!)",
      "id": "oddfprice_invalid_schedule_settlement_after_first_1bc49b18aff1"
    },
    {
      "formula": "=ODDFYIELD(DATE(2020,8,1),DATE(2025,1,1),DATE(2020,1,1),DATE(2020,7,1),0.05,98,100,2,0)",
      "outputCell": "C1",
      "inputs": [],
      "tags": [
        "financial",
        "odd_coupon",
        "invalid_schedule",
        "ODDFYIELD"
      ],
      "description": "ODDFYIELD invalid schedule: settlement is after first_coupon (expected #NUM!)",
      "id": "oddfyield_invalid_schedule_settlement_after_first_938531ed93bc"
    }
  ]
}
