# Encrypted workbook fixtures

This directory contains **real encrypted Excel files** used for end-to-end decryption/opening
tests. All files contain only trivial spreadsheet content (no sensitive data).

## Passwords

### OOXML (`EncryptionInfo` + `EncryptedPackage`) fixtures

| Fixture | Format | Encryption | Password |
| --- | --- | --- | --- |
| `encrypted_agile.xlsx` | OOXML | Agile | `password` |
| `encrypted_standard.xlsx` | OOXML | Standard (ECMA-376 Standard) | `password` |
| `encrypted_agile.xlsm` | OOXML | Agile (macro-enabled) | `password` |
| `encrypted_agile_unicode.xlsx` | OOXML | Agile | `pässwörd` |

### Legacy `.xls` (`FILEPASS`) fixtures

| Fixture | Format | Encryption | Password |
| --- | --- | --- | --- |
| `encrypted_rc4_cryptoapi.xls` | BIFF8 | RC4 CryptoAPI (`FILEPASS`) | `password` |
| `encrypted_rc4_cryptoapi_unicode.xls` | BIFF8 | RC4 CryptoAPI (`FILEPASS`) | `pässwörd` |
| `biff8_rc4_cryptoapi_pw_open.xls` | BIFF8 | RC4 CryptoAPI (`FILEPASS`) | `correct horse battery staple` |
| `biff8_rc4_cryptoapi_boundary_pw_open.xls` | BIFF8 | RC4 CryptoAPI (`FILEPASS`) | `password` |

Notes:

- `biff8_rc4_cryptoapi_pw_open.xls` is also used by `formula-xls` tests under
  `crates/formula-xls/tests/fixtures/encrypted/`.
- `biff8_rc4_cryptoapi_boundary_pw_open.xls` crosses the 1024-byte RC4 re-key boundary and is a
  real workbook generated by Microsoft Excel.

## Regenerating

The `encrypted_*` fixtures can be regenerated from the plaintext templates shipped in the repo by
running:

```bash
bash scripts/generate_encryption_fixtures.sh
```

This is a thin wrapper over:

```bash
cargo run -p formula-office-crypto --example generate_fixtures
```

The generator uses small, existing plaintext templates from the repo:

- `fixtures/xlsx/basic/basic.xlsx`
- `fixtures/xlsx/macros/basic.xlsm` (contains a small VBA project)
- `crates/formula-xls/tests/fixtures/basic.xls`

