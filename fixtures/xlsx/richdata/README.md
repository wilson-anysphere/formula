# RichData / Linked Data Types fixtures

This directory contains **small** `.xlsx` fixtures intended to exercise Excel’s
modern **Linked Data Types** / **RichData** packaging:

- `xl/metadata.xml`
- `xl/_rels/metadata.xml.rels`
- `xl/richData/*`
- `vm="…"` / `cm="…"` attributes on worksheet `<c>` (cell) elements

## `linked-data-types.xlsx`

`linked-data-types.xlsx` is meant to be a minimal workbook containing:

- `Sheet1!A1`: a **Stocks** linked data type (e.g. `MSFT`)
- `Sheet1!A2`: a **Geography** linked data type (e.g. `Seattle`)

### Provenance note

The `linked-data-types.xlsx` currently checked into this repo is **synthetic** (generated by Formula’s
fixture tooling), as indicated by `docProps/app.xml` containing:

```xml
<Application>Formula Fixtures</Application>
```

It is still useful for exercising round-trip preservation of rich-data parts (see
`crates/formula-xlsx/tests/linked_data_types_fixture.rs`), but it should not be treated as Excel ground
truth. If/when a real Excel-saved linked-data-types fixture is added, prefer that file for definitive
schema validation.

Note: this repository also contains `fixtures/xlsx/rich-data/` which is the
original home for RichData fixtures and includes an Excel-saved “images in cell”
fixture. The long-term intent is that **linked data types fixtures should also
be saved by Excel 365** (for ground-truth schema validation). If this file ever
needs to be regenerated, prefer producing it in Excel 365 and re-checking that
it still round-trips cleanly in tests.

### Regenerating (Excel 365)

1. Create a new blank workbook.
2. Enter `MSFT` in `A1`, then **Data** → **Data Types** → **Stocks**.
3. Enter `Seattle` in `A2`, then **Data** → **Data Types** → **Geography**.
4. Save as `linked-data-types.xlsx`.
5. Verify the rich-data parts exist:

```bash
unzip -Z1 fixtures/xlsx/richdata/linked-data-types.xlsx | rg '^xl/(metadata\\.xml|_rels/metadata\\.xml\\.rels|richData/)'
unzip -p fixtures/xlsx/richdata/linked-data-types.xlsx xl/worksheets/sheet1.xml | rg ' vm=| cm='
```

For additional sanity checking (content types + relationship type URIs):

```bash
unzip -p fixtures/xlsx/richdata/linked-data-types.xlsx \\[Content_Types\\].xml | rg 'richvalue'
unzip -p fixtures/xlsx/richdata/linked-data-types.xlsx xl/_rels/metadata.xml.rels | rg 'schemas\\.microsoft\\.com/office/2017/relationships/richValue'
```
