# XLSX `xl/metadata.xml` fixtures

This directory contains small `.xlsx` fixtures that exercise Excel’s **workbook metadata** part
`xl/metadata.xml` (and related worksheet cell attributes like `c/@vm` and `c/@cm`).

## Provenance

Most fixtures in this folder are **synthetic** and generated by Formula’s fixture tooling (check
`docProps/app.xml` → `<Application>Formula Fixtures</Application>` when present).

These files are useful for:

- regression testing Formula’s round-trip/preservation behavior, and
- documenting OOXML wiring patterns that exist “in the wild” (including patterns produced by other
  non-Excel tooling).

They are **not** intended to be Excel ground truth. For real Excel rich-data / images-in-cell fixtures,
see:

- `fixtures/xlsx/basic/image-in-cell.xlsx`
- `fixtures/xlsx/rich-data/images-in-cell.xlsx`

## Notable fixture: `rich-values-vm.xlsx`

`rich-values-vm.xlsx` is a minimal workbook that includes:

- `xl/metadata.xml` containing a Rich Value metadata type (`metadataType name="XLRICHVALUE"`) and a
  `futureMetadata` / `xlrd:rvb` mapping table.
- `xl/workbook.xml` containing a `<metadata r:id="..."/>` element (in addition to the relationship in
  `xl/_rels/workbook.xml.rels`).
- `xl/worksheets/sheet1.xml` containing a cell with a `vm="1"` attribute.

It is used by:

- `crates/formula-xlsx/tests/metadata_rich_values_vm_roundtrip.rs`

for verifying that `xl/metadata.xml` and worksheet `vm="…"` attributes are preserved when editing/saving.

