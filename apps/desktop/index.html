<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formula Desktop</title>
    <!-- Load startup instrumentation before the main app entrypoint so the webview can report
         "JS started executing" as early as possible (reduces startup metric skew). -->
    <script type="module" async src="/src/tauri/startupMetricsBootstrap.ts"></script>
    <script type="module" src="/src/main.ts"></script>
  </head>
  <body>
    <div id="app" class="formula-app">
      <div id="titlebar-root" data-testid="titlebar"></div>
      <div id="ribbon" data-testid="ribbon">
        <div id="ribbon-react-root"></div>
      </div>
      <div id="formula-bar"></div>
      <div id="workspace">
        <div id="dock-left" data-testid="dock-left"></div>
        <div id="dock-right" data-testid="dock-right"></div>
        <div id="dock-bottom" data-testid="dock-bottom"></div>
        <div id="floating-root" data-testid="floating-root"></div>
        <div id="grid-split" data-testid="grid-split">
          <div id="grid" class="grid-root" tabindex="0" aria-label="Spreadsheet grid"></div>
          <div id="grid-splitter" data-testid="grid-splitter"></div>
          <div
            id="grid-secondary"
            class="grid-root"
            data-testid="grid-secondary"
            tabindex="0"
            aria-label="Secondary spreadsheet grid"
          ></div>
        </div>
      </div>
      <div id="sheet-tabs" class="sheet-bar" data-testid="sheet-tabs"></div>
        <div class="statusbar">
          <div class="statusbar__main">
            <div class="statusbar-mode" data-testid="status-mode">Ready</div>
            <div class="statusbar-readonly" data-testid="read-only-indicator" hidden></div>
            <div class="statusbar__spacer"></div>
            <div class="statusbar__item" data-testid="selection-sum">Sum: 0</div>
            <div class="statusbar__item" data-testid="selection-avg">Avg: 0</div>
            <div class="statusbar__item" data-testid="selection-count">Count: 0</div>
          <select data-testid="zoom-control" aria-label="Zoom">
            <option value="25">25%</option>
            <option value="50">50%</option>
            <option value="75">75%</option>
            <option value="100" selected>100%</option>
            <option value="125">125%</option>
            <option value="150">150%</option>
            <option value="200">200%</option>
            <option value="400">400%</option>
           </select>
           <div class="statusbar__item" data-testid="status-zoom">100%</div>
            <div
              class="statusbar__item"
              data-testid="sheet-position"
              data-sheet-position="1"
              data-sheet-total="1"
              role="status"
              aria-label="Sheet position"
              aria-live="polite"
              aria-atomic="true"
            >
             Sheet 1 of 1
           </div>
           <button type="button" data-testid="open-version-history-panel" aria-label="Open version history">
             Version history
           </button>
          <button type="button" data-testid="open-branch-manager-panel" aria-label="Open branch manager">
            Branches
          </button>
          <button type="button" data-testid="open-marketplace-panel-statusbar" aria-label="Open marketplace">
            Marketplace
          </button>
          <div class="statusbar__item statusbar__collab">
            <span>Collab:</span>
            <span
              data-testid="collab-status"
              role="status"
              aria-label="Collaboration status"
              aria-live="polite"
              aria-atomic="true"
            >
              Local
            </span>
          </div>
        </div>
        <div class="statusbar__debug">
            <div>
              Active:
             <code data-testid="active-cell">A1</code>
           </div>
          <div>
            Sheet:
            <select data-testid="sheet-switcher"></select>
          </div>
          <div>
            Selection:
            <code data-testid="selection-range">A1</code>
          </div>
          <div>
            Value:
            <code data-testid="active-value"></code>
          </div>
        </div>
      </div>
    </div>
    <div id="toast-root" data-testid="toast-root" aria-live="polite" aria-atomic="true"></div>
  </body>
</html>
