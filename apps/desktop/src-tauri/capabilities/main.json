{
  "$schema": "../gen/schemas/desktop-schema.json",
  "identifier": "main",
  "description": "Permissions for the main desktop window (explicit IPC allowlist).",
  "local": true,
  "windows": ["main"],
  "permissions": [
    "core:default",
    {
      "identifier": "core:allow-invoke",
      "allow": [
        "open_workbook",
        "new_workbook",
        "add_sheet",
        "rename_sheet",
        "move_sheet",
        "delete_sheet",
        "read_text_file",
        "read_binary_file",
        "read_binary_file_range",
        "stat_file",
        "list_dir",
        "open_external_url",
        "clipboard_read",
        "clipboard_write",
        "read_clipboard",
        "write_clipboard",
        "power_query_cache_key_get_or_create",
        "power_query_credential_get",
        "power_query_credential_set",
        "power_query_credential_delete",
        "power_query_credential_list",
        "power_query_refresh_state_get",
        "power_query_refresh_state_set",
        "power_query_state_get",
        "power_query_state_set",
        "sql_query",
        "sql_get_schema",
        "save_workbook",
        "mark_saved",
        "get_workbook_theme_palette",
        "list_defined_names",
        "list_tables",
        "get_cell",
        "get_precedents",
        "get_dependents",
        "set_cell",
        "get_range",
        "get_sheet_used_range",
        "set_range",
        "create_pivot_table",
        "refresh_pivot_table",
        "list_pivot_tables",
        "recalculate",
        "undo",
        "redo",
        "get_sheet_print_settings",
        "set_sheet_page_setup",
        "set_sheet_print_area",
        "export_sheet_range_pdf",
        "get_vba_project",
        "list_macros",
        "get_macro_security_status",
        "set_macro_trust",
        "set_macro_ui_context",
        "run_macro",
        "validate_vba_migration",
        "run_python_script",
        "check_for_updates",
        "restart_app",
        "quit_app",
        "fire_workbook_open",
        "fire_workbook_before_close",
        "fire_worksheet_change",
        "fire_selection_change",
        "set_tray_status",
        "show_system_notification",
        "oauth_loopback_listen",
        "report_startup_webview_loaded",
        "report_startup_tti"
      ]
    },
    {
      "identifier": "event:allow-listen",
      "allow": [
        { "event": "close-prep" },
        { "event": "close-requested" },

        { "event": "open-file" },
        { "event": "file-dropped" },

        { "event": "tray-open" },
        { "event": "tray-new" },
        { "event": "tray-quit" },

        { "event": "shortcut-quick-open" },
        { "event": "shortcut-command-palette" },

        { "event": "menu-open" },
        { "event": "menu-new" },
        { "event": "menu-save" },
        { "event": "menu-save-as" },
        { "event": "menu-export-pdf" },
        { "event": "menu-close-window" },
        { "event": "menu-quit" },
        { "event": "menu-undo" },
        { "event": "menu-redo" },
        { "event": "menu-cut" },
        { "event": "menu-copy" },
        { "event": "menu-paste" },
        { "event": "menu-paste-special" },
        { "event": "menu-select-all" },
        { "event": "menu-zoom-in" },
        { "event": "menu-zoom-out" },
        { "event": "menu-zoom-reset" },
        { "event": "menu-about" },
        { "event": "menu-check-updates" },
        { "event": "menu-open-release-page" },
        { "event": "startup:window-visible" },
        { "event": "startup:webview-loaded" },
        { "event": "startup:tti" },
        { "event": "startup:metrics" },

        { "event": "update-check-started" },
        { "event": "update-check-already-running" },
        { "event": "update-not-available" },
        { "event": "update-check-error" },
        { "event": "update-available" },

        { "event": "oauth-redirect" }
      ]
    },
    {
      "identifier": "event:allow-emit",
      "allow": [
        { "event": "open-file-ready" },
        { "event": "oauth-redirect-ready" },
        { "event": "close-prep-done" },
        { "event": "close-handled" },
        { "event": "coi-check-result" },
        { "event": "updater-ui-ready" }
      ]
    },
    "dialog:allow-open",
    "dialog:allow-save",
    "core:window:allow-hide",
    "core:window:allow-show",
    "core:window:allow-set-focus",
    "core:window:allow-close",
    "clipboard-manager:allow-read-text",
    "clipboard-manager:allow-write-text",
    "updater:allow-check",
    "updater:allow-download",
    "updater:allow-install"
  ]
}
