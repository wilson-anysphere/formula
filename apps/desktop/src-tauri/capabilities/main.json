{
  "$schema": "../gen/schemas/desktop-schema.json",
  "identifier": "main",
  "description": "Permissions for the main desktop window (explicit IPC allowlist).",
  "local": true,
  "windows": ["main"],
  "permissions": [
    "allow-invoke",
    {
      "identifier": "core:allow-invoke",
      "allow": [
        { "command": "add_sheet" },
        { "command": "add_sheet_with_id" },
        { "command": "apply_sheet_formatting_deltas" },
        { "command": "check_for_updates" },
        { "command": "clipboard_read" },
        { "command": "clipboard_write" },
        { "command": "collab_encryption_key_delete" },
        { "command": "collab_encryption_key_get" },
        { "command": "collab_encryption_key_list" },
        { "command": "collab_encryption_key_set" },
        { "command": "collab_token_delete" },
        { "command": "collab_token_get" },
        { "command": "collab_token_set" },
        { "command": "create_pivot_table" },
        { "command": "delete_sheet" },
        { "command": "export_sheet_range_pdf" },
        { "command": "fire_selection_change" },
        { "command": "fire_workbook_before_close" },
        { "command": "fire_workbook_open" },
        { "command": "fire_worksheet_change" },
        { "command": "get_dependents" },
        { "command": "get_macro_security_status" },
        { "command": "get_precedents" },
        { "command": "get_range" },
        { "command": "get_sheet_formatting" },
        { "command": "get_sheet_print_settings" },
        { "command": "get_sheet_used_range" },
        { "command": "get_vba_project" },
        { "command": "get_workbook_theme_palette" },
        { "command": "install_downloaded_update" },
        { "command": "list_defined_names" },
        { "command": "list_dir" },
        { "command": "list_macros" },
        { "command": "list_pivot_tables" },
        { "command": "list_tables" },
        { "command": "mark_saved" },
        { "command": "marketplace_download_package" },
        { "command": "marketplace_get_extension" },
        { "command": "marketplace_search" },
        { "command": "move_sheet" },
        { "command": "network_fetch" },
        { "command": "new_workbook" },
        { "command": "open_external_url" },
        { "command": "open_workbook" },
        { "command": "oauth_loopback_listen" },
        { "command": "power_query_cache_key_get_or_create" },
        { "command": "power_query_credential_delete" },
        { "command": "power_query_credential_get" },
        { "command": "power_query_credential_list" },
        { "command": "power_query_credential_set" },
        { "command": "power_query_refresh_state_get" },
        { "command": "power_query_refresh_state_set" },
        { "command": "power_query_state_get" },
        { "command": "power_query_state_set" },
        { "command": "quit_app" },
        { "command": "read_binary_file" },
        { "command": "read_binary_file_range" },
        { "command": "read_clipboard" },
        { "command": "read_text_file" },
        { "command": "refresh_pivot_table" },
        { "command": "rename_sheet" },
        { "command": "reorder_sheets" },
        { "command": "report_startup_tti" },
        { "command": "report_startup_webview_loaded" },
        { "command": "restart_app" },
        { "command": "run_macro" },
        { "command": "run_python_script" },
        { "command": "save_workbook" },
        { "command": "set_cell" },
        { "command": "set_macro_trust" },
        { "command": "set_macro_ui_context" },
        { "command": "set_range" },
        { "command": "set_sheet_page_setup" },
        { "command": "set_sheet_print_area" },
        { "command": "set_sheet_tab_color" },
        { "command": "set_sheet_visibility" },
        { "command": "set_tray_status" },
        { "command": "show_system_notification" },
        { "command": "sql_get_schema" },
        { "command": "sql_query" },
        { "command": "stat_file" },
        { "command": "validate_vba_migration" },
        { "command": "verify_ed25519_signature" },
        { "command": "write_clipboard" }
      ]
    },
    {
      "identifier": "core:event:allow-listen",
      "allow": [
        { "event": "close-prep" },
        { "event": "close-requested" },
        { "event": "open-file" },
        { "event": "file-dropped" },
        { "event": "tray-open" },
        { "event": "tray-new" },
        { "event": "tray-quit" },
        { "event": "shortcut-quick-open" },
        { "event": "shortcut-command-palette" },
        { "event": "menu-open" },
        { "event": "menu-new" },
        { "event": "menu-save" },
        { "event": "menu-save-as" },
        { "event": "menu-print" },
        { "event": "menu-print-preview" },
        { "event": "menu-export-pdf" },
        { "event": "menu-close-window" },
        { "event": "menu-quit" },
        { "event": "menu-undo" },
        { "event": "menu-redo" },
        { "event": "menu-cut" },
        { "event": "menu-copy" },
        { "event": "menu-paste" },
        { "event": "menu-paste-special" },
        { "event": "menu-select-all" },
        { "event": "menu-zoom-in" },
        { "event": "menu-zoom-out" },
        { "event": "menu-zoom-reset" },
        { "event": "menu-about" },
        { "event": "menu-check-updates" },
        { "event": "menu-open-release-page" },
        { "event": "startup:window-visible" },
        { "event": "startup:webview-loaded" },
        { "event": "startup:tti" },
        { "event": "startup:metrics" },
        { "event": "update-check-started" },
        { "event": "update-check-already-running" },
        { "event": "update-not-available" },
        { "event": "update-check-error" },
        { "event": "update-available" },
        { "event": "update-download-started" },
        { "event": "update-download-progress" },
        { "event": "update-downloaded" },
        { "event": "update-download-error" },
        { "event": "oauth-redirect" }
      ]
    },
    {
      "identifier": "core:event:allow-emit",
      "allow": [
        { "event": "close-prep-done" },
        { "event": "close-handled" },
        { "event": "open-file-ready" },
        { "event": "oauth-redirect-ready" },
        { "event": "updater-ui-ready" },
        { "event": "coi-check-result" }
      ]
    },
    "core:event:allow-unlisten",
    "dialog:allow-open",
    "dialog:allow-save",
    "dialog:allow-confirm",
    "dialog:allow-message",
    "core:window:allow-hide",
    "core:window:allow-show",
    "core:window:allow-set-focus",
    "core:window:allow-close",
    "core:window:allow-minimize",
    "core:window:allow-toggle-maximize",
    "core:window:allow-maximize",
    "core:window:allow-unmaximize",
    "core:window:allow-is-maximized",
    "clipboard-manager:allow-read-text",
    "clipboard-manager:allow-write-text",
    "updater:allow-check",
    "updater:allow-download",
    "updater:allow-install"
  ]
}
