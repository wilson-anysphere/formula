/*
  Design tokens (CSS variables)
  Source of truth: docs/12-ux-design.md

  Notes:
  - Keep token names stable; prefer adding new tokens over renaming.
  - Theme selection is controlled by setting `data-theme` on <html>.
  - High contrast is supported both via explicit `data-theme="high-contrast"`
    and via OS forced-colors / prefers-contrast media queries.
*/

:root {
  color-scheme: light;

  /* Base surfaces */
  --bg-primary: #ffffff;
  --bg-secondary: #f5f5f5;
  --bg-tertiary: #e8e8e8;

  /*
    Extended surfaces (app chrome)

    These tokens map more directly to the UI mockups (titlebar/ribbon/statusbar)
    so new shell UI can be built without introducing hardcoded colors.
  */
  --bg-app: var(--bg-secondary);
  --bg-surface: #fafafa;
  --bg-elevated: var(--bg-primary);
  --bg-hover: #eeeeee;
  --bg-active: #e4e4e4;
  --bg-inset: #f0f0f0;

  /* Base text */
  --text-primary: #1a1a1a;
  --text-secondary: #666666;
  --text-tertiary: #8a8a8a;
  --text-muted: var(--text-secondary);

  /* Lines / separators */
  --border: #d4d4d4;
  --border-strong: #c8c8c8;

  /* Brand / interactive */
  --accent: #0066cc;
  --accent-light: #e6f0ff;
  --accent-bg: var(--accent-light);
  --accent-border: var(--accent);

  /* Semantic */
  --error: #d32f2f;
  --warning: #ed6c02;
  --success: #2e7d32;
  --warning-bg: rgba(237, 108, 2, 0.12);

  /* Text on strong accent backgrounds (buttons, etc.) */
  --text-on-accent: #ffffff;

  /* Selection / focus */
  --selection-bg: var(--accent-bg);
  --selection-border: var(--accent-border);
  --selection-text: var(--text-primary);

  /* Grid chrome */
  --grid-header-bg: var(--bg-secondary);
  --grid-header-text: var(--text-primary);
  --grid-line: var(--border);

  /* Charts */
  --chart-bg: var(--bg-primary);
  --chart-border: var(--border);
  --chart-axis: var(--text-secondary);
  --chart-title: var(--text-primary);
  --chart-placeholder-bg: var(--bg-secondary);
  --chart-placeholder-border: var(--border);
  --chart-label: var(--text-secondary);

  /* Chart series palette (defaults to Tableau 10-inspired hues). */
  --chart-series-1: #4e79a7;
  --chart-series-2: #f28e2b;
  --chart-series-3: #e15759;
  --chart-series-4: #76b7b2;

  /* Panels / dialogs */
  --panel-bg: var(--bg-secondary);
  --panel-border: var(--border);
  --panel-shadow: -2px 0 10px rgba(0, 0, 0, 0.08);
  --dialog-bg: var(--bg-primary);
  --dialog-border: var(--border);
  --dialog-shadow: 0 10px 25px rgba(0, 0, 0, 0.35);
  --dialog-backdrop: rgba(0, 0, 0, 0.4);

  /* Tooltips */
  --tooltip-bg: rgba(17, 24, 39, 0.95);
  --tooltip-text: #ffffff;

  /* Command palette */
  --cmdk-bg: var(--bg-secondary);
  --cmdk-border: var(--border);
  --cmdk-input-bg: var(--bg-tertiary);

  /* Formula bar */
  --formula-bar-bg: var(--bg-secondary);
  --formula-bar-border: var(--border);

  /* Shape / depth */
  --radius: 6px;
  --radius-sm: 4px;
  --shadow-surface: 0 1px 2px rgba(0, 0, 0, 0.08);

  /* Motion */
  --motion-duration: 160ms;
  --motion-duration-fast: 80ms;
  --motion-ease: cubic-bezier(0.2, 0, 0, 1);
}

:root[data-theme="dark"] {
  color-scheme: dark;

  --bg-primary: #1e1e1e;
  --bg-secondary: #252526;
  --bg-tertiary: #333333;

  --bg-app: var(--bg-primary);
  --bg-surface: var(--bg-secondary);
  --bg-elevated: var(--bg-tertiary);
  --bg-hover: #2f2f2f;
  --bg-active: #3a3a3a;
  --bg-inset: var(--bg-primary);

  --text-primary: #e4e4e4;
  --text-secondary: #a0a0a0;
  --text-tertiary: #7a7a7a;

  --border: #404040;
  --border-strong: #5a5a5a;

  --accent: #4da6ff;
  --accent-light: #1a3a5c;

  --error: #f44336;
  --warning: #ff9800;
  --success: #4caf50;
  --warning-bg: rgba(255, 152, 0, 0.14);

  /* Accent backgrounds in dark are typically light, so dark text reads best. */
  --text-on-accent: #1e1e1e;

  --shadow-surface: 0 1px 2px rgba(0, 0, 0, 0.5);

  --panel-shadow: -2px 0 10px rgba(0, 0, 0, 0.4);
  --tooltip-bg: rgba(0, 0, 0, 0.85);
  --tooltip-text: #ffffff;

  --dialog-shadow: 0 10px 25px rgba(0, 0, 0, 0.7);
  --dialog-backdrop: rgba(0, 0, 0, 0.55);
}

:root[data-theme="high-contrast"] {
  /* In explicit high contrast mode, prefer system colors for maximum legibility. */
  color-scheme: light dark;

  --bg-primary: Canvas;
  --bg-secondary: Canvas;
  --bg-tertiary: Canvas;

  --bg-app: Canvas;
  --bg-surface: Canvas;
  --bg-elevated: Canvas;
  --bg-hover: Canvas;
  --bg-active: Canvas;
  --bg-inset: Canvas;

  --text-primary: CanvasText;
  --text-secondary: CanvasText;
  --text-tertiary: CanvasText;

  --border: CanvasText;
  --border-strong: CanvasText;

  --accent: Highlight;
  --accent-light: Highlight;
  --accent-bg: Highlight;
  --accent-border: Highlight;

  --error: CanvasText;
  --warning: CanvasText;
  --success: CanvasText;
  --warning-bg: Highlight;

  --text-on-accent: HighlightText;
  --selection-text: HighlightText;

  --panel-shadow: none;
  --shadow-surface: none;
  --tooltip-bg: CanvasText;
  --tooltip-text: Canvas;

  --dialog-shadow: none;
  --dialog-backdrop: transparent;
}

@media (forced-colors: active), (prefers-contrast: more) {
  :root {
    color-scheme: light dark;

    --bg-primary: Canvas;
    --bg-secondary: Canvas;
    --bg-tertiary: Canvas;

    --bg-app: Canvas;
    --bg-surface: Canvas;
    --bg-elevated: Canvas;
    --bg-hover: Canvas;
    --bg-active: Canvas;
    --bg-inset: Canvas;

    --text-primary: CanvasText;
    --text-secondary: CanvasText;
    --text-tertiary: CanvasText;

    --border: CanvasText;
    --border-strong: CanvasText;

    --accent: Highlight;
    --accent-light: Highlight;
    --accent-bg: Highlight;
    --accent-border: Highlight;

    --text-on-accent: HighlightText;
    --selection-text: HighlightText;

    --shadow-surface: none;
  }
}

/* Explicit hook for runtime detection (e.g., in a canvas renderer). */
:root[data-reduced-motion="true"] {
  --motion-duration: 0ms;
  --motion-duration-fast: 0ms;
  --motion-ease: linear;
}

@media (prefers-reduced-motion: reduce) {
  :root {
    --motion-duration: 0ms;
    --motion-duration-fast: 0ms;
    --motion-ease: linear;
  }
}
